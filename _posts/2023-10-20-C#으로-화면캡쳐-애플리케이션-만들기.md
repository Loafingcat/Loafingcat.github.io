---
layout: post
title: "C#으로 화면캡쳐 애플리케이션 만들기"
author: "LoafingCat"
---


[2023-10-20]

인터페이스 구성

![이미지 41](https://github.com/Loafingcat/JungolCodeTestLoafingcat/assets/98324619/457b8f7c-32ca-4ea5-90f5-3e44e0240c76)

캡쳐할 화면을 보여주는 image와 캡쳐할 화면을 고를 combobox, 캡쳐할 캡쳐 버튼을 만들었다.


[2023-10-21]

스크린 캡쳐를 하기 위해 네임스페이스 추가

using System.Drawing;

using System.Runtime.InteropServices;

using System.Collections.Generic;

using System.Windows.Interop;

using System.Windows.Media.Imaging;

User32의 FindWindow 함수를 사용하여 창 핸들(Handle)을 획득하고 해당 창의 스크린 캡처를 표시하는 방향으로 가야겠다.

User32.dll을 사용하기 위해 DllImport를 사용하여 User32 라이브러리를 임포트해야한다고 함.

[2023-10-23]

위 방법으로 시도해보려 했으나 진행이 더디고 코드가 실행되지 않았다. 

한 번에 다 하려 하지말고 기본적인 기능부터 추가해보려함. 캡쳐와 캡쳐한 이미지를 보여주는 기능을 만들어보자.

bitmap을 사용하고 싶었으니 자꾸 system.drawing이 비활성화 상태가 됨.

해결책

![이미지 44](https://github.com/Loafingcat/JungolCodeTestLoafingcat/assets/98324619/1dbe37af-5f7b-4811-a578-a4b55883dbcf)

에러 코드를 읽어보면 system.drawing.common이 필요하다는 것을 알 수 있다.

![이미지 47](https://github.com/Loafingcat/JungolCodeTestLoafingcat/assets/98324619/e59d8215-e06f-4e45-966c-f8c731e0c1c3)

프로잭트 이름에서 우클릭하여 NuGet 패키지 관리에 들어가준다.

![이미지 48](https://github.com/Loafingcat/JungolCodeTestLoafingcat/assets/98324619/6d6de892-03f1-44c9-8c07-acf4fa262eba)

system.drawing.common을 찾아 설치해준다.

그럼 system.drawing 네임스페이스가 제대로 작동한다.



